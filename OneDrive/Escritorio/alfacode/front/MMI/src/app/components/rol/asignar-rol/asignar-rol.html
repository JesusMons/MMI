<p-card class="w-full h-full">
  <ng-template pTemplate="header">
    <div class="header">
      <h3 class="title">Asignar Rol a Usuarios</h3>
    </div>
  </ng-template>

  <div *ngIf="error" class="error">{{ error }}</div>
  <div *ngIf="loading">Cargando…</div>

  <p-table
    *ngIf="!loading"
    [value]="usuarios"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5,10,20]"
    styleClass="w-full">
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 80px;">ID</th>
        <th>Usuario</th>
        <th>Correo</th>
        <th>Rol a asignar</th>
        <th style="width: 140px; text-align:center;">Acción</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-u>
      <tr>
        <td>{{ u.id }}</td>
        <td>{{ u.username }}</td>
        <td>{{ u.email || '-' }}</td>
        <td>
          <select
            class="select"
            [(ngModel)]="selectedRole[u.id]">
            <option [ngValue]="null">— Seleccionar —</option>
            <option *ngFor="let r of roles" [ngValue]="r.id">
              {{ r.nombre }}
            </option>
          </select>
        </td>
        <td class="center">
          <button class="btn btn-primary" (click)="asignar(u)">Asignar</button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>
